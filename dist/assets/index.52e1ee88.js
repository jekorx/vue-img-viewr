var e=Object.defineProperty,n=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,o=Object.prototype.propertyIsEnumerable,a=(n,l,o)=>l in n?e(n,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[l]=o,i=(e,i)=>{for(var s in i||(i={}))n.call(i,s)&&a(e,s,i[s]);if(l)for(var s of l(i))o.call(i,s)&&a(e,s,i[s]);return e};import{d as s,r as t,a as r,c,w as u,b as d,o as m,e as v,n as g,f as w,g as h,h as p,i as _,v as f,j as b,k,F as y,l as I,m as x,T as C,p as O,q as S,s as A,t as z,u as M,x as L}from"./vendor.11a6248b.js";!function(e=".",n="__import__"){try{self[n]=new Function("u","return import(u)")}catch(l){const o=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[n]=e=>new Promise(((l,i)=>{const s=new URL(e,o);if(self[n].moduleMap[s])return l(self[n].moduleMap[s]);const t=new Blob([`import * as m from '${s}';`,`${n}.moduleMap['${s}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(t),onerror(){i(new Error(`Failed to import: ${e}`)),a(r)},onload(){l(self[n].moduleMap[s]),a(r)}});document.head.appendChild(r)})),self[n].moduleMap={}}}("/vue-img-viewr/assets/");const $="undefined"==typeof window,j=(e,n,l,o=!1)=>{!$&&e&&n&&l&&e.addEventListener(n,l,o)},E=(e,n,l,o=!1)=>{!$&&e&&n&&l&&e.removeEventListener(n,l,o)};function R(e){let n=!1;return function(...l){n||(n=!0,window.requestAnimationFrame((()=>{e.apply(this,l),n=!1})))}}const D={CONTAIN:{name:"contain",icon:"img-viewr__icon icon__full-screen"},ORIGINAL:{name:"original",icon:"img-viewr__icon icon__scale-to-original"}},H=!$&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",N="Escape",T="ArrowLeft",F="ArrowUp",B="ArrowRight",U="ArrowDown",X="Space";var Y=s({name:"ImgViewr",props:{visible:{type:Boolean,default:!1},urls:{type:Array,default:()=>[]},zIndex:{type:Number,default:3e3},initialIndex:{type:Number,default:0},lockScroll:{type:Boolean,default:!0},closeOnClickMask:{type:Boolean,default:!0}},emits:["close","switch","show"],setup(e,{emit:n}){const l=t(0),o=t(3e3),a=t(!0),s=t(!0),w=t(!1),h=t([]),p=t(null),_=t(null),f=t(null),b=t(0),k=t(!0),y=t(!1),I=r(i({},D.CONTAIN)),x=r({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),C=t(null),O=t(null),S=c((()=>h.value.length<=1)),A=c((()=>0===b.value)),z=c((()=>b.value===h.value.length-1)),M=c((()=>h.value[b.value]||h.value[0])),L=c((()=>{const{scale:e,deg:n,offsetX:l,offsetY:o,enableTransition:a}=x,i={transform:`scale(${e}) rotate(${n}deg)`,transition:a?"transform .3s":"","margin-left":`${l}px`,"margin-top":`${o}px`};return I.name===D.CONTAIN.name&&(i.maxWidth=i.maxHeight="100%"),i}));u((()=>{e.urls.length&&(h.value=e.urls,l.value=e.initialIndex,o.value=e.zIndex,a.value=e.lockScroll,s.value=e.closeOnClickMask)})),d((()=>e.visible),(e=>{w.value=e})),d(l,(e=>{e!==b.value&&(b.value=e)})),d(w,(e=>{var l;if(!a.value)return;const o=document.body.classList;e?(W(),o.contains("img-viewr__body-lock")||o.add("img-viewr__body-lock")):o.contains("img-viewr__body-lock")&&o.remove("img-viewr__body-lock"),null==(l=f.value)||l.call(f,e),n("show",e)})),d(b,(e=>{var l;W(),null==(l=_.value)||l.call(_,e),n("switch",e)})),d(M,(()=>{g((()=>{const e=O.value;e&&e.complete||(y.value=!0)}))}));const $=()=>{var e;null==(e=p.value)||e.call(p),n("close")};let Y,P,V;const W=()=>{x.scale=1,x.deg=0,x.offsetX=0,x.offsetY=0,x.enableTransition=!1},q=()=>{if(y.value)return;const e=Object.keys(D),n=(Object.values(D).findIndex((({name:e})=>e===I.name))+1)%e.length,{name:l,icon:o}=D[e[n]];I.name=l,I.icon=o,W()},J=()=>{if(A.value&&!k.value)return;const e=h.value.length;b.value=(b.value-1+e)%e},G=()=>{if(z.value&&!k.value)return;const e=h.value.length;b.value=(b.value+1)%e},K=(e,n={})=>{if(y.value)return;const{zoomRate:l,rotateDeg:o,enableTransition:a}=i({zoomRate:.2,rotateDeg:90,enableTransition:!0},n);switch(e){case"zoomOut":x.scale>.2&&(x.scale=parseFloat((x.scale-l).toFixed(3)));break;case"zoomIn":x.scale=parseFloat((x.scale+l).toFixed(3));break;case"clocelise":x.deg+=o;break;case"anticlocelise":x.deg-=o;break;case"download":((e,n,l)=>{const o=new Image,a=document.createElement("canvas"),i=a.getContext("2d"),s=document.createElement("a");o.setAttribute("crossOrigin","anonymous"),o.src=e,o.onerror=()=>{window.open(e)},o.onload=()=>{a.width=o.width,a.height=o.height,null==i||i.drawImage(o,0,0,o.width,o.height),s.setAttribute("href",a.toDataURL(`image/${l}`)),s.setAttribute("target","_blank"),s.setAttribute("download",`${n}.${l}`),s.click()}})(M.value,Date.now().toString(),"png")}x.enableTransition=a};return m((()=>{var e,n;Y=R((e=>{switch(e.code){case N:$();break;case X:q();break;case T:J();break;case F:K("zoomIn");break;case B:G();break;case U:K("zoomOut")}})),P=R((e=>{const n=e.wheelDelta?e.wheelDelta:-e.detail;K(n>0?"zoomIn":"zoomOut",{zoomRate:.05,enableTransition:!1})})),j(document,"keydown",Y),j(document,H,P),null==(n=null==(e=null==C?void 0:C.value)?void 0:e.focus)||n.call(e)})),v((()=>{Y&&E(document,"keydown",Y),P&&E(document,H,P),Y=null,P=null})),{images:h,isShow:w,initIndex:l,zIndexNum:o,isLockScroll:a,isCloseOnClickMask:s,imgViewrWrapper:C,imageRef:O,index:b,isSingle:S,infinite:k,isFirst:A,isLast:z,mode:I,currentImg:M,imgStyle:L,closeHandle:p,switchHandle:_,showHandle:f,hide:$,prev:J,next:G,toggleMode:q,handleActions:K,handleMaskClick:()=>{s.value&&$()},handleImgLoad:()=>{y.value=!1},handleImgError:()=>{y.value=!1;const e=O.value;e&&(e.alt="加载失败")},handleMouseDown:e=>{if(y.value||0!==e.button)return;const{offsetX:n,offsetY:l}=x,o=e.pageX,a=e.pageY;V=R((e=>{x.offsetX=n+e.pageX-o,x.offsetY=l+e.pageY-a})),j(document,"mousemove",V),j(document,"mouseup",(()=>{V&&E(document,"mousemove",V)})),e.preventDefault()}}}});const P=b("i",{class:"img-viewr__icon icon__circle-close"},null,-1),V=b("i",{class:"img-viewr__icon icon__arrow-left"},null,-1),W=b("i",{class:"img-viewr__icon icon__arrow-right"},null,-1),q={class:"img-viewr__btn img-viewr__actions"},J={class:"img-viewr__actions__inner"},G=b("i",{class:"img-viewr__actions__divider"},null,-1),K=b("i",{class:"img-viewr__actions__divider"},null,-1),Q=b("i",{class:"img-viewr__actions__divider"},null,-1),Z={class:"img-viewr__canvas"};Y.render=function(e,n,l,o,a,i){return h(),w(C,{name:"img-viewr-fade"},{default:p((()=>[_(b("div",{tabindex:"-1",ref:"imgViewrWrapper",class:"img-viewr__wrapper",style:`z-index: ${e.zIndexNum}`},[b("div",{class:"img-viewr__mask",onClick:n[1]||(n[1]=k(((...n)=>e.handleMaskClick&&e.handleMaskClick(...n)),["self"]))}),b("span",{class:"img-viewr__btn img-viewr__close",onClick:n[2]||(n[2]=(...n)=>e.hide&&e.hide(...n))},[P]),e.isSingle?I("",!0):(h(),w(y,{key:0},[b("span",{class:["img-viewr__btn img-viewr__prev",{"is-disabled":!e.infinite&&e.isFirst}],onClick:n[3]||(n[3]=(...n)=>e.prev&&e.prev(...n))},[V],2),b("span",{class:["img-viewr__btn img-viewr__next",{"is-disabled":!e.infinite&&e.isLast}],onClick:n[4]||(n[4]=(...n)=>e.next&&e.next(...n))},[W],2)],64)),b("div",q,[b("div",J,[b("i",{class:"img-viewr__icon icon__zoom-out",onClick:n[5]||(n[5]=n=>e.handleActions("zoomOut"))}),b("i",{class:"img-viewr__icon icon__zoom-in",onClick:n[6]||(n[6]=n=>e.handleActions("zoomIn"))}),G,b("i",{class:e.mode.icon,onClick:n[7]||(n[7]=(...n)=>e.toggleMode&&e.toggleMode(...n))},null,2),K,b("i",{class:"img-viewr__icon icon__download-image",onClick:n[8]||(n[8]=n=>e.handleActions("download"))}),Q,b("i",{class:"img-viewr__icon icon__refresh-left",onClick:n[9]||(n[9]=n=>e.handleActions("anticlocelise"))}),b("i",{class:"img-viewr__icon icon__refresh-right",onClick:n[10]||(n[10]=n=>e.handleActions("clocelise"))})])]),b("div",Z,[(h(!0),w(y,null,x(e.images,((l,o)=>(h(),w(y,null,[o===e.index?(h(),w("img",{class:"img-viewr__img",ref:"imageRef",key:l,src:e.currentImg,style:e.imgStyle,onLoad:n[11]||(n[11]=(...n)=>e.handleImgLoad&&e.handleImgLoad(...n)),onError:n[12]||(n[12]=(...n)=>e.handleImgError&&e.handleImgError(...n)),onMousedown:n[13]||(n[13]=(...n)=>e.handleMouseDown&&e.handleMouseDown(...n))},null,44,["src"])):I("",!0)],64)))),256))])],4),[[f,e.isShow]])])),_:1})};const ee="undefined"==typeof window;let ne;const le=e=>{var n,l,o,a,i;if(ee)return;if(!(e.urls&&e.urls.length>0))throw new Error("At least one picture in urls array!");ne||(()=>{const e=document.createElement("div"),n=b(Y,{});n&&n.props&&(n.props.onDestroy=()=>{O(null,e)}),O(n,e),ne=n,e.firstElementChild&&document.body.appendChild(e.firstElementChild)})();const s=null==(n=null==ne?void 0:ne.component)?void 0:n.proxy;s.images=e.urls,s.initIndex=null!=(l=e.index)?l:0,s.zIndexNum=null!=(o=e.zIndex)?o:3e3,s.isLockScroll=null==(a=e.lockScroll)||a,s.isCloseOnClickMask=null==(i=e.closeOnClickMask)||i,s.closeHandle=()=>{var n;s.isShow=!1,null==(n=e.onClose)||n.call(e)},s.switchHandle=n=>{var l;null==(l=e.onSwitch)||l.call(e,n)},s.showHandle=n=>{var l;null==(l=e.onShow)||l.call(e,n)},setTimeout((()=>{s.isShow=!0}),0)};Y.showImages=le,Y.install=e=>{e.config.globalProperties.$showImages=le,e.component(Y.name,Y)};const oe=["https://s.gravatar.com/avatar/221f86a573320174bad7a62886a6d4b4?size=100&default=retro","https://s.gravatar.com/avatar/221f86a573320174bad7a62886a6d4b4","https://static.npmjs.com/attachments/ck3uwf5d872zb8874c3ayi1pj-icon-pro-wombat-3x.png"];var ae=s({name:"App",setup(){const e=t(oe),n=t(0),l=t(!1),o=e=>{console.log(`current image index: ${e}`)},a=e=>{console.log(`component is show: ${e}`)};return{urls:e,index:n,visible:l,showImagesByComponent:e=>{l.value=!0,n.value=e},showImagesByJs:e=>{le({urls:oe,index:e,onSwitch:o,onClose:()=>{console.log("close with js")},onShow:a})},closeHandle:()=>{console.log("close component"),l.value=!1},changeHandle:o,showHandle:a}}});const ie=S();A("data-v-43c9a2bf");const se=b("h3",null,"通过组件方式",-1),te={class:"imgs"},re=b("h3",null,"通过js方法调用",-1),ce={class:"imgs"};z();const ue=ie(((e,n,l,o,a,i)=>{const s=M("ImgViewr");return h(),w("div",null,[se,b("div",te,[(h(!0),w(y,null,x(e.urls,((n,l)=>(h(),w("div",{class:"img",key:`c_${l}`,onClick:()=>e.showImagesByComponent(l)},[b("img",{src:n},null,8,["src"])],8,["onClick"])))),128))]),b(s,{visible:e.visible,urls:e.urls,"initial-index":e.index,onClose:e.closeHandle,onSwitch:e.changeHandle,onShow:e.showHandle},null,8,["visible","urls","initial-index","onClose","onSwitch","onShow"]),re,b("div",ce,[(h(!0),w(y,null,x(e.urls,((n,l)=>(h(),w("div",{class:"img",key:l,onClick:()=>e.showImagesByJs(l)},[b("img",{src:n},null,8,["src"])],8,["onClick"])))),128))])])}));ae.render=ue,ae.__scopeId="data-v-43c9a2bf";const de=L(ae);de.config.globalProperties.$showImages=le,de.component("ImgViewr",Y),de.mount("#app");
